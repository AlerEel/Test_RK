# Госуслуги: Парсер инспекций и веб-интерфейс

## Описание

Проект предназначен для автоматического сбора данных о проверках с портала Госуслуг, их сохранения в базу данных SQLite и просмотра через современный веб-интерфейс.

- Получение заголовков для API через Playwright (эмулируется браузер).
- Парсинг данных с устойчивостью к ошибкам структуры.
- Сохранение результатов только в базу данных `data/inspections.db`.
- Современный веб-интерфейс на FastAPI + Jinja2 + Bootstrap с пагинацией.

---

## Установка

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
   (или вручную: `requests`, `fastapi`, `uvicorn`, `jinja2`, `playwright`, `python-dateutil`, `aiosqlite` и др.)
2. Для работы Playwright выполните:
   ```bash
   playwright install
   ```

---

## Запуск парсинга и загрузки данных

```bash
python app.py
```
- Сначала автоматически получаются заголовки для API.
- Затем запускается парсер, данные сохраняются в базу данных `data/inspections.db`.
- После завершения появится инструкция для запуска сервера.

---

## Запуск веб-интерфейса

```bash
python scripts/server.py
```
- Откройте браузер и перейдите по адресу: [http://localhost:5001/](http://localhost:5001/)
- Веб-интерфейс позволяет просматривать результаты с пагинацией.

---

## Структура проекта

- `app.py` — единая точка запуска: получение заголовков, парсинг, сохранение, инструкция по запуску сервера.
- `scripts/` — вспомогательные скрипты:
    - `inspections_parser.py` — основной парсер (ООП, устойчивость к ошибкам, логгирование).
    - `headers_extractor.py` — автоматическое получение заголовков через Playwright.
    - `load_to_sqlite.py` — загрузка данных в SQLite (ООП).
    - `server.py` — FastAPI сервер, отдаёт веб-интерфейс и статику.
- `data/` — база данных SQLite (`inspections.db`).
- `templates/` — HTML-шаблоны (Jinja2 + Bootstrap).
- `static/` — локальные CSS/JS (Bootstrap и др.).

---

## Требования
- Python 3.8+
- Playwright (и браузеры: `playwright install`)
- FastAPI, Uvicorn, Jinja2, Requests, python-dateutil, aiosqlite

---

## Лицензия
MIT (или ваша лицензия) 
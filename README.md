# Госуслуги: Парсер инспекций и веб-интерфейс

## Описание

Проект предназначен для автоматического сбора данных о проверках с портала Госуслуг, их сохранения в базу данных SQLite и просмотра через веб-интерфейс.

- Получение заголовков для API через Playwright (эмулируется браузер).
- Парсинг данных и автоматическое обновление каждые 10 минут.
- Сохранение результатов в базу данных `data/inspections.db`.
- Веб-интерфейс на FastAPI + Jinja2 + Bootstrap с пагинацией.

---

## Установка

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
2. Для работы Playwright выполните:
   ```bash
   playwright install
   ```

---

## Запуск сервера и автоматического парсинга

```bash
python app.py
```
- При запуске:
  - Сначала автоматически парсятся и обновляются данные (запись в базу данных).
  - Затем запускается веб-сервер FastAPI.
  - Каждые 10 минут данные обновляются автоматически.
- Откройте браузер и перейдите по адресу: [http://localhost:5001/]
- Веб-интерфейс позволяет просматривать результаты с пагинацией.

---

## Структура проекта

- `app.py` — основная точка запуска: FastAPI сервер, автоматический парсинг и обновление данных.
- `scripts/` — вспомогательные скрипты:
    - `inspections_parser.py` — основной парсер (ООП, устойчивость к ошибкам, логгирование).
    - `headers_extractor.py` — автоматическое получение заголовков через Playwright (асинхронно).
    - `load_to_sqlite.py` — загрузка данных в SQLite (ООП).
- `data/` — база данных SQLite (`inspections.db`), файл времени последнего обновления.
- `templates/` — HTML-шаблоны (Jinja2 + Bootstrap).
- `static/` — локальные CSS/JS (Bootstrap и др.).

---

## Требования
- Python 3.8+
- Playwright (и браузеры: `playwright install`)
- FastAPI, Uvicorn, Jinja2, Requests, python-dateutil, aiosqlite

---
